import { retryUntil } from '@aztec/barretenberg/retry';
import { InterruptableSleep, sleep } from '@aztec/barretenberg/sleep';
import { Timer } from '@aztec/barretenberg/timer';
import { createPermitData, createPermitDataNonStandard, validateSignature, Web3Signer, } from '@aztec/blockchain';
export class DepositHandler {
    constructor(assetValue, fee, depositor, recipient, recipientSpendingKeyRequired, core, blockchain, provider) {
        this.assetValue = assetValue;
        this.fee = fee;
        this.depositor = depositor;
        this.recipient = recipient;
        this.recipientSpendingKeyRequired = recipientSpendingKeyRequired;
        this.core = core;
        this.blockchain = blockchain;
        this.provider = provider;
        this.pendingFundsStatus = { pendingDeposit: BigInt(0), pendingFunds: BigInt(0), requiredFunds: BigInt(0) };
        const { assetId, value } = assetValue;
        if (!blockchain.getAsset(assetId)) {
            throw new Error('Unsupported asset.');
        }
        if (fee.assetId !== assetId && fee.value && value) {
            throw new Error('Inconsistent asset id.');
        }
        this.publicInput = { assetId, value: value + fee.value };
    }
    async getPendingFunds() {
        const { pendingFunds } = await this.getPendingFundsStatus();
        return pendingFunds;
    }
    async getRequiredFunds() {
        const { requiredFunds } = await this.getPendingFundsStatus();
        return requiredFunds;
    }
    async getPublicAllowance() {
        const { assetId } = this.publicInput;
        const { rollupContractAddress } = await this.core.getLocalStatus();
        return this.blockchain.getAsset(assetId).allowance(this.depositor, rollupContractAddress);
    }
    hasPermitSupport() {
        const { assetId } = this.publicInput;
        return this.blockchain.hasPermitSupport(assetId);
    }
    async approve(permitDeadline) {
        const pendingFundsStatus = await this.getPendingFundsStatus();
        const value = pendingFundsStatus.requiredFunds;
        if (!value) {
            throw new Error('User has deposited enough funds.');
        }
        const allowance = await this.getPublicAllowance();
        if (allowance >= value) {
            throw new Error('User has approved enough amount.');
        }
        const isContract = await this.blockchain.isContract(this.depositor);
        const permitSupport = this.hasPermitSupport() && !isContract;
        if (permitSupport) {
            const permitArgs = await this.createPermitArgs(value, permitDeadline);
            this.pendingFundsStatus = {
                ...pendingFundsStatus,
                permitArgs,
            };
        }
        else {
            const { assetId } = this.publicInput;
            const { rollupContractAddress } = await this.core.getLocalStatus();
            const approve = () => this.blockchain.getAsset(assetId).approve(value, this.depositor, rollupContractAddress, {
                signingAddress: this.depositor,
                provider: this.provider,
            });
            let approveTxHash;
            if (!isContract) {
                approveTxHash = await approve();
            }
            else {
                const checkOnchainData = async () => {
                    const allowance = await this.getPublicAllowance();
                    return allowance >= value;
                };
                approveTxHash = await this.sendTransactionAndCheckOnchainData('approve allowance from contract wallet', approve, checkOnchainData);
            }
            this.pendingFundsStatus = {
                ...pendingFundsStatus,
                approvedFromContractWallet: isContract && !approveTxHash,
                approveTxHash,
            };
            return approveTxHash;
        }
    }
    async awaitApprove(timeout, interval) {
        const { approvedFromContractWallet, approveTxHash, requiredFunds } = this.pendingFundsStatus;
        if (approvedFromContractWallet) {
            return;
        }
        if (!approveTxHash) {
            throw new Error('Call approve() first.');
        }
        const checkOnchainData = async () => {
            const allowance = await this.getPublicAllowance();
            return allowance >= requiredFunds;
        };
        await this.awaitTransaction('approve allowance', checkOnchainData, timeout, interval);
    }
    async depositFundsToContract(permitDeadline) {
        const pendingFundsStatus = await this.getPendingFundsStatus();
        const value = pendingFundsStatus.requiredFunds;
        if (!value) {
            throw new Error('User has deposited enough funds.');
        }
        const { assetId } = this.publicInput;
        const isContract = await this.blockchain.isContract(this.depositor);
        const permitSupport = this.hasPermitSupport() && !isContract;
        const allowance = assetId === 0 ? value : await this.getPublicAllowance();
        if (!permitSupport && allowance < value) {
            throw new Error('Insufficient allowance. Call approve() first.');
        }
        const depositFunds = async () => {
            if (permitSupport && allowance < value) {
                const { signature, deadline } = pendingFundsStatus.permitArgs || (await this.createPermitArgs(value, permitDeadline));
                return this.blockchain.depositPendingFundsPermit(assetId, value, deadline, signature, {
                    signingAddress: this.depositor,
                    provider: this.provider,
                });
            }
            else {
                const proofHash = isContract ? this.getProofHash() : undefined;
                return this.blockchain.depositPendingFunds(assetId, value, proofHash, {
                    signingAddress: this.depositor,
                    provider: this.provider,
                });
            }
        };
        let txHash;
        if (!isContract) {
            txHash = await depositFunds();
        }
        else {
            const { pendingDeposit, requiredFunds } = pendingFundsStatus;
            const expectedPendingDeposit = pendingDeposit + requiredFunds;
            const checkOnchainData = async () => {
                const value = await this.blockchain.getUserPendingDeposit(assetId, this.depositor);
                return value === expectedPendingDeposit;
            };
            txHash = await this.sendTransactionAndCheckOnchainData('deposit funds from contract wallet', depositFunds, checkOnchainData);
        }
        this.pendingFundsStatus = {
            ...pendingFundsStatus,
            depositedFromContractWallet: isContract && !txHash,
            txHash,
        };
        return txHash;
    }
    async depositFundsToContractWithNonStandardPermit(permitDeadline) {
        const pendingFundsStatus = await this.getPendingFundsStatus();
        const value = pendingFundsStatus.requiredFunds;
        if (!value) {
            throw new Error('User has deposited enough funds.');
        }
        const isContract = await this.blockchain.isContract(this.depositor);
        if (isContract) {
            throw new Error('Permit flow not available for contract wallets.');
        }
        let txHash;
        const { assetId } = this.publicInput;
        const allowance = await this.getPublicAllowance();
        if (allowance >= value) {
            txHash = await this.blockchain.depositPendingFunds(assetId, value, undefined, {
                signingAddress: this.depositor,
                provider: this.provider,
            });
        }
        else {
            const { signature, deadline, nonce } = await this.createPermitArgsNonStandard(permitDeadline);
            txHash = await this.blockchain.depositPendingFundsPermitNonStandard(assetId, value, nonce, deadline, signature, {
                signingAddress: this.depositor,
                provider: this.provider,
            });
        }
        this.pendingFundsStatus = {
            ...pendingFundsStatus,
            txHash,
        };
        return txHash;
    }
    async awaitDepositFundsToContract(timeout, interval) {
        const { depositedFromContractWallet, txHash, pendingDeposit, requiredFunds } = this.pendingFundsStatus;
        if (depositedFromContractWallet) {
            return true;
        }
        if (!txHash) {
            throw new Error('Call depositFundsToContract() first.');
        }
        const { assetId } = this.publicInput;
        const expectedPendingDeposit = pendingDeposit + requiredFunds;
        const checkOnchainData = async () => {
            const value = await this.blockchain.getUserPendingDeposit(assetId, this.depositor);
            return value === expectedPendingDeposit;
        };
        await this.awaitTransaction('deposit pending funds', checkOnchainData, timeout, interval);
    }
    async createProof(txRefNo = 0, timeout) {
        const { assetId, value } = this.publicInput;
        const privateOutput = value - this.fee.value;
        this.depositProofOutput = await this.core.createDepositProof(assetId, value, // publicInput,
        privateOutput, this.depositor, this.recipient, this.recipientSpendingKeyRequired, txRefNo, timeout);
    }
    getProofOutput() {
        if (!this.depositProofOutput) {
            throw new Error('Call createProof() first.');
        }
        return this.depositProofOutput;
    }
    getProofHash() {
        if (!this.depositProofOutput) {
            throw new Error('Call createProof() first.');
        }
        return this.depositProofOutput.tx.txId.toBuffer();
    }
    async isProofApproved() {
        const proofHash = this.getProofHash();
        return !!(await this.blockchain.getUserProofApprovalStatus(this.depositor, proofHash));
    }
    async approveProof() {
        const proofHash = this.getProofHash();
        const isContract = await this.blockchain.isContract(this.depositor);
        const approveProof = () => this.blockchain.approveProof(proofHash, {
            signingAddress: this.depositor,
            provider: this.provider,
        });
        let approveProofTxHash;
        if (!isContract) {
            approveProofTxHash = await approveProof();
        }
        else {
            const checkOnchainData = () => this.isProofApproved();
            approveProofTxHash = await this.sendTransactionAndCheckOnchainData('approve proof from contract wallet', approveProof, checkOnchainData);
        }
        this.pendingFundsStatus = {
            ...this.pendingFundsStatus,
            proofApprovedFromContractWallet: isContract && !approveProofTxHash,
            approveProofTxHash,
        };
        return approveProofTxHash;
    }
    async awaitApproveProof(timeout, interval) {
        const { proofApprovedFromContractWallet, approveProofTxHash } = this.pendingFundsStatus;
        if (proofApprovedFromContractWallet) {
            return true;
        }
        if (!approveProofTxHash) {
            throw new Error('Call approveProof() first.');
        }
        const checkOnchainData = () => this.isProofApproved();
        await this.awaitTransaction('approve proof', checkOnchainData, timeout, interval);
    }
    getSigningData() {
        if (!this.depositProofOutput) {
            throw new Error('Call createProof() first.');
        }
        return this.depositProofOutput.tx.txId.toDepositSigningData();
    }
    async sign() {
        if (!this.depositProofOutput) {
            throw new Error('Call createProof() first.');
        }
        const ethSigner = new Web3Signer(this.provider);
        const signingData = this.getSigningData();
        this.depositProofOutput.signature = await ethSigner.signPersonalMessage(signingData, this.depositor);
    }
    isSignatureValid() {
        if (!this.depositProofOutput) {
            throw new Error('Call createProof() and sign() first.');
        }
        if (!this.depositProofOutput.signature) {
            throw new Error('Call sign() first.');
        }
        const signingData = this.getSigningData();
        return validateSignature(this.depositor, this.depositProofOutput.signature, signingData);
    }
    async getPendingFundsStatus() {
        const { assetId } = this.publicInput;
        const pendingDeposit = await this.blockchain.getUserPendingDeposit(assetId, this.depositor);
        const txs = await this.core.getPendingDepositTxs();
        const unsettledDeposit = txs
            .filter(tx => tx.assetId === assetId && tx.publicOwner.equals(this.depositor))
            .reduce((sum, tx) => sum + BigInt(tx.value), BigInt(0));
        const pendingFunds = pendingDeposit - unsettledDeposit;
        const { value } = this.publicInput;
        const requiredFunds = pendingFunds < value ? value - pendingFunds : BigInt(0);
        return { ...this.pendingFundsStatus, pendingDeposit, pendingFunds, requiredFunds };
    }
    async createPermitArgs(value, permitDeadline) {
        const deadline = permitDeadline ?? BigInt(Math.floor(Date.now() / 1000) + 5 * 60); // Default deadline is 5 mins from now.
        const { assetId } = this.publicInput;
        const asset = this.blockchain.getAsset(assetId);
        const nonce = await asset.getUserNonce(this.depositor);
        const { permitHelperContractAddress, chainId } = await this.core.getLocalStatus();
        const permitData = createPermitData(asset.getStaticInfo().name, this.depositor, permitHelperContractAddress, value, nonce, deadline, asset.getStaticInfo().address, this.getContractChainId(chainId));
        const ethSigner = new Web3Signer(this.provider);
        const signature = await ethSigner.signTypedData(permitData, this.depositor);
        return { signature, deadline };
    }
    async createPermitArgsNonStandard(permitDeadline) {
        const deadline = permitDeadline ?? BigInt(Math.floor(Date.now() / 1000) + 5 * 60); // Default deadline is 5 mins from now.
        const { assetId } = this.publicInput;
        const asset = this.blockchain.getAsset(assetId);
        const nonce = await asset.getUserNonce(this.depositor);
        const { permitHelperContractAddress, chainId } = await this.core.getLocalStatus();
        const permitData = createPermitDataNonStandard(asset.getStaticInfo().name, this.depositor, permitHelperContractAddress, nonce, deadline, asset.getStaticInfo().address, this.getContractChainId(chainId));
        const ethSigner = new Web3Signer(this.provider);
        const signature = await ethSigner.signTypedData(permitData, this.depositor);
        return { signature, deadline, nonce };
    }
    getContractChainId(chainId) {
        // Any references to the chainId in the contracts on mainnet-fork (like the DOMAIN_SEPARATOR for permit data)
        // will have to be 1.
        switch (chainId) {
            case 0xa57ec:
            case 0xdef:
            case 0xe2e:
                return 1;
            default:
                return chainId;
        }
    }
    async sendTransactionAndCheckOnchainData(name, sendTx, checkOnchainData, timeout, interval = 1) {
        const interruptableSleep = new InterruptableSleep();
        let txHash;
        let txError;
        // May never return due to wallet connect provider bugs.
        void (async () => {
            try {
                txHash = await sendTx();
            }
            catch (e) {
                txError = e;
            }
            interruptableSleep.interrupt();
        })();
        const timer = new Timer();
        while (!txHash && !txError) {
            // We want confidence the tx will be accepted, so simulate waiting for confirmations.
            if (await checkOnchainData()) {
                const secondsTillConfirmed = (this.blockchain.minConfirmations - 1) * 15;
                await sleep(secondsTillConfirmed * 1000);
                break;
            }
            await interruptableSleep.sleep(interval * 1000);
            if (timeout && timer.s() > timeout) {
                throw new Error(`Timeout awaiting chain state condition: ${name}`);
            }
        }
        if (txError) {
            throw txError;
        }
        return txHash;
    }
    async awaitTransaction(name, confirmedFromOnchainData, timeout, interval = 1) {
        await retryUntil(confirmedFromOnchainData, `chain state condition: ${name}`, timeout, interval);
        // We want confidence the tx will be accepted, so simulate waiting for confirmations.
        const secondsTillConfirmed = (this.blockchain.minConfirmations - 1) * 15;
        await sleep(secondsTillConfirmed * 1000);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwb3NpdF9oYW5kbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbnRyb2xsZXJzL2RlcG9zaXRfaGFuZGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLEtBQUssRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNsRCxPQUFPLEVBRUwsZ0JBQWdCLEVBQ2hCLDJCQUEyQixFQUMzQixpQkFBaUIsRUFDakIsVUFBVSxHQUNYLE1BQU0sbUJBQW1CLENBQUM7QUFJM0IsTUFBTSxPQUFPLGNBQWM7SUFnQnpCLFlBQ2tCLFVBQXNCLEVBQ3RCLEdBQWUsRUFDZixTQUFxQixFQUNyQixTQUEwQixFQUMxQiw0QkFBcUMsRUFDbEMsSUFBYSxFQUNmLFVBQW9DLEVBQ3BDLFFBQTBCO1FBUDNCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdEIsUUFBRyxHQUFILEdBQUcsQ0FBWTtRQUNmLGNBQVMsR0FBVCxTQUFTLENBQVk7UUFDckIsY0FBUyxHQUFULFNBQVMsQ0FBaUI7UUFDMUIsaUNBQTRCLEdBQTVCLDRCQUE0QixDQUFTO1FBQ2xDLFNBQUksR0FBSixJQUFJLENBQVM7UUFDZixlQUFVLEdBQVYsVUFBVSxDQUEwQjtRQUNwQyxhQUFRLEdBQVIsUUFBUSxDQUFrQjtRQXJCckMsdUJBQWtCLEdBV3RCLEVBQUUsY0FBYyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxZQUFZLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLGFBQWEsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQVluRixNQUFNLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxHQUFHLFVBQVUsQ0FBQztRQUN0QyxJQUFJLENBQUMsVUFBVSxD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