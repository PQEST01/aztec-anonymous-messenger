import { TxType } from '@aztec/barretenberg/blockchain';
import { DefiDepositProofData, JoinSplitProofData, ProofData, ProofId } from '@aztec/barretenberg/client_proofs';
import { roundUp } from '@aztec/barretenberg/rounding';
const accumeFees = (fees0, fees1) => !fees1.length ? fees0 : fees0.map((fee, i) => ({ ...fee, value: fee.value + fees1[i].value }));
const accumeBaseFees = (fees0, fees1) => !fees1.length ? fees0 : fees0.map(fee => ({ ...fee, value: fee.value + fees1[0].value }));
export class FeeCalculator {
    constructor(core, blockchain) {
        this.core = core;
        this.blockchain = blockchain;
    }
    async getDepositFees(assetId, options = {}) {
        return await this.getTransactionFees(assetId, TxType.DEPOSIT, options);
    }
    async getWithdrawFees(assetId, { recipient, ...options } = {}) {
        const txType = recipient && !(await this.blockchain.isContract(recipient)) && !(await this.blockchain.isEmpty(recipient))
            ? TxType.WITHDRAW_TO_WALLET
            : TxType.WITHDRAW_HIGH_GAS;
        return await this.getTransactionFees(assetId, txType, options);
    }
    async getTransferFees(assetId, options) {
        return await this.getTransactionFees(assetId, TxType.TRANSFER, options);
    }
    async getDefiFees(bridgeCallData, options = {}) {
        const { userId, userSpendingKeyRequired, assetValue, feeSignificantFigures = 0 } = options;
        const assetId = bridgeCallData.inputAssetIdA;
        if (assetValue && assetValue.assetId !== assetId) {
            throw new Error('Inconsistent asset id.');
        }
        const fees = await this.core.getDefiFees(bridgeCallData);
        const feeAssetId = fees[0].assetId;
        const [transferFee] = (await this.core.getTxFees(feeAssetId))[TxType.TRANSFER];
        if (!assetValue) {
            const numTxs = feeAssetId !== assetId ? 1 : 0;
            return fees.map(fee => ({
                ...fee,
                value: roundUp(fee.value + transferFee.value * BigInt(numTxs), feeSignificantFigures),
            }));
        }
        if (!userId) {
            throw new Error(`'userId' not provided.`);
        }
        const depositValue = assetValue.value;
        let { excludePendingNotes } = options;
        if (bridgeCallData.inputAssetIdB !== undefined) {
            const noteB = await this.core.pickNote(userId, bridgeCallData.inputAssetIdB, depositValue, userSpendingKeyRequired, excludePendingNotes);
            if (noteB?.value === depositValue) {
                excludePendingNotes = excludePendingNotes || noteB.pending;
            }
            else {
                // Need to create chained txs to merge or split notes for assetB.
                const notes = await this.core.pickNotes(userId, bridgeCallData.inputAssetIdB, depositValue, userSpendingKeyRequired, excludePendingNotes);
                excludePendingNotes = excludePendingNotes || notes.some(n => n.pending);
                const numTxs = !notes.length ? 0 : Math.max(1, notes.length - 1);
                // User does not have enough notes for assetB that sum to the required value. Return 0 fees.
                if (!numTxs) {
                    return fees.map(fee => ({
                        ...fee,
                        value: BigInt(0),
                    }));
                }
                // We are creating chained txs for assetB => need to find a note for assetA that has the exact value.
                if (feeAssetId !== assetId) {
                    const noteA = await this.core.pickNote(userId, assetId, depositValue, userSpendingKeyRequired, excludePendingNotes);
                    // Return 0 fees if can't find a note for assetA with the exact value.
                    if (noteA?.value !== depositValue) {
                        return fees.map(fee => ({
                            ...fee,
                            value: BigInt(0),
                        }));
                    }
                    const accFees = fees.map(fee => ({ ...fee, value: fee.value + transferFee.value * BigInt(numTxs) }));
                    return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, { ...options, excludePendingNotes });
                }
                else {
                    return await Promise.all(fees.map(async (fee) => {
                        const requiredFee = roundUp(fee.value + transferFee.value * BigInt(numTxs), feeSignificantFigures);
                        const noteValueA = depositValue + requiredFee;
                        const noteA = await this.core.pickNote(userId, assetId, noteValueA, userSpendingKeyRequired, excludePendingNotes);
                        // Return 0 fee if can't find a note for assetA with the exact value.
                        return {
                            ...fee,
                            value: noteA?.value !== noteValueA ? BigInt(0) : requiredFee,
                        };
                    }));
                }
            }
        }
        // Get the number of merges needed to create the exact note value for assetA.
        const getNumMerges = async (valueA) => {
            const notes = await this.core.pickNotes(userId, assetId, valueA, userSpendingKeyRequired, excludePendingNotes);
            if (!notes.length) {
                return;
            }
            if (bridgeCallData.numInputAssets === 2) {
                const note = await this.core.pickNote(userId, assetId, valueA, userSpendingKeyRequired, excludePendingNotes);
                if (note?.value === valueA) {
                    return 0;
                }
                else {
                    return Math.max(1, notes.length - 1);
                }
            }
            else {
                const totalNoteValue = notes.reduce((sum, n) => sum + n.value, BigInt(0));
                if (notes.length <= 2 && totalNoteValue === valueA) {
                    return 0;
                }
                else {
                    return Math.max(1, notes.length - 2);
                }
            }
        };
        if (feeAssetId !== assetId) {
            const numMerges = await getNumMerges(depositValue);
            if (numMerges === undefined) {
                return fees.map(fee => ({ ...fee, value: BigInt(0) }));
            }
            const accFees = fees.map(fee => ({ ...fee, value: fee.value + transferFee.value * BigInt(numMerges + 1) }));
            return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, { ...options, excludePendingNotes });
        }
        else {
            const spendableValue = await this.core.getSpendableSum(userId, assetId, userSpendingKeyRequired, excludePendingNotes);
            const getChainedTxsFee = async (baseFee) => {
                let totalValue = depositValue + roundUp(baseFee, feeSignificantFigures);
                let numMerges = 0;
                while (totalValue <= spendableValue) {
                    const requiredNumMerges = (await getNumMerges(totalValue));
                    if (requiredNumMerges <= numMerges) {
                        return totalValue - depositValue;
                    }
                    numMerges = requiredNumMerges;
                    totalValue = depositValue + roundUp(baseFee + transferFee.value * BigInt(numMerges), feeSignificantFigures);
                }
                // Need to deposit or transfer one more note with enough value.
                const numNotes = 1 +
                    (await this.core.pickNotes(userId, assetId, spendableValue, userSpendingKeyRequired, excludePendingNotes))
                        .length;
                const expectedNumMerges = Math.max(0, numNotes - 2);
                return roundUp(baseFee + transferFee.value * BigInt(expectedNumMerges), feeSignificantFigures);
            };
            return await Promise.all(fees.map(async (fee) => ({ ...fee, value: await getChainedTxsFee(fee.value) })));
        }
    }
    async getRegisterFees(assetId, options = {}) {
        return await this.getAccountFees(assetId, options);
    }
    async getRecoverAccountFees(assetId, options = {}) {
        return await this.getAccountFees(assetId, options);
    }
    async getAddSpendingKeyFees(assetId, options = {}) {
        const txFees = await this.core.getTxFees(assetId);
        const fees = txFees[TxType.ACCOUNT];
        const [transferFee] = txFees[TxType.TRANSFER];
        const accFees = fees.map(fee => ({ ...fee, value: fee.value + transferFee.value }));
        return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, options);
    }
    async getMigrateAccountFees(assetId, options = {}) {
        return await this.getAccountFees(assetId, options);
    }
    async getProofDataFees(assetId, proofs, options = {}) {
        const txFees = await this.core.getTxFees(assetId);
        const [transferFee] = txFees[TxType.TRANSFER];
        const defiFeesMap = new Map();
        const defiProofTxsFees = [];
        const proofTxsFees = [];
        for (const proofData of proofs) {
            const proofId = ProofData.getProofIdFromBuffer(proofData);
            switch (proofId) {
                case ProofId.DEPOSIT:
                    proofTxsFees.push(txFees[TxType.DEPOSIT]);
                    break;
                case ProofId.SEND:
                    proofTxsFees.push(txFees[TxType.TRANSFER]);
                    break;
                case ProofId.ACCOUNT:
                    proofTxsFees.push(txFees[TxType.ACCOUNT]);
                    break;
                case ProofId.WITHDRAW: {
                    const { publicOwner } = new JoinSplitProofData(new ProofData(proofData));
                    const txType = (await this.blockchain.isContract(publicOwner)) || (await this.blockchain.isEmpty(publicOwner))
                        ? TxType.WITHDRAW_HIGH_GAS
                        : TxType.WITHDRAW_TO_WALLET;
                    proofTxsFees.push(txFees[txType]);
                    break;
                }
                case ProofId.DEFI_DEPOSIT: {
                    const { bridgeCallData } = new DefiDepositProofData(new ProofData(proofData));
                    const bid = bridgeCallData.toString();
                    const defiFees = defiFeesMap.get(bid) || (await this.core.getDefiFees(bridgeCallData));
                    if (!defiFeesMap.has(bid)) {
                        defiProofTxsFees.push([defiFees[0], defiFees[1], defiFees[1]]);
                        defiFeesMap.set(bid, defiFees);
                    }
                    else {
                        defiProofTxsFees.push([defiFees[0], defiFees[0], defiFees[0]]);
                    }
                }
            }
        }
        const defiAccFees = defiProofTxsFees.reduce((accFees, fees, i) => (!i ? fees : accumeFees(accFees, fees)), []);
        // Always add a transfer fee for the fee paying tx.
        const feePayingTxFee = [...txFees[TxType.TRANSFER]];
        if (defiProofTxsFees.length) {
            feePayingTxFee.unshift(transferFee);
        }
        const accFees = [accumeFees(feePayingTxFee, defiAccFees), ...proofTxsFees].reduce((accFees, fees, i) => (!i ? fees : accumeBaseFees(accFees, fees)), []);
        return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, options);
    }
    async getTransactionFees(assetId, txType, options = {}) {
        const { userId, userSpendingKeyRequired, assetValue, excludePendingNotes } = options;
        const txFees = await this.core.getTxFees(assetId);
        const [transferFee] = txFees[TxType.TRANSFER];
        const fees = txFees[txType];
        const feeAssetId = fees[0].assetId;
        if (!assetValue?.value) {
            const accFees = feeAssetId === assetId ? fees : fees.map(fee => ({ ...fee, value: fee.value + transferFee.value }));
            return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, options);
        }
        if (!userId) {
            throw new Error(`'userId' not provided.`);
        }
        const getNumNotes = async (privateInput) => {
            const notes = await this.core.pickNotes(userId, privateInput.assetId, privateInput.value, userSpendingKeyRequired, excludePendingNotes);
            return notes.length;
        };
        const getNumMerges = async (privateInput) => {
            const numNotes = await getNumNotes(privateInput);
            return Math.max(0, numNotes - 2);
        };
        if (feeAssetId !== assetValue.assetId) {
            const numMerges = await getNumMerges(assetValue);
            const accFees = fees.map(fee => ({ ...fee, value: fee.value + transferFee.value * BigInt(numMerges + 1) }));
            return await this.getChainedTxsFee(BigInt(0), accFees, transferFee, options);
        }
        else {
            return await this.getChainedTxsFee(assetValue.value, fees, transferFee, options);
        }
    }
    async getChainedTxsFee(baseValue, fees, transferFee, options) {
        const { assetId } = transferFee;
        const { userId, userSpendingKeyRequired, excludePendingNotes, feeSignificantFigures = 0 } = options;
        if (!userId) {
            return fees.map(fee => ({ ...fee, value: roundUp(fee.value, feeSignificantFigures) }));
        }
        const getNumNotes = async (value) => {
            const notes = await this.core.pickNotes(userId, assetId, value, userSpendingKeyRequired, excludePendingNotes);
            return notes.length;
        };
        const getNumMerges = async (value) => {
            const numNotes = await getNumNotes(value);
            return Math.max(0, numNotes - 2);
        };
        const spendableValue = await this.core.getSpendableSum(userId, assetId, userSpendingKeyRequired, excludePendingNotes);
        const getTotalFee = async (baseFee) => {
            let totalValue = baseValue + roundUp(baseFee, feeSignificantFigures);
            let numMerges = 0;
            while (totalValue <= spendableValue) {
                const requiredNumMerges = await getNumMerges(totalValue);
                if (requiredNumMerges <= numMerges) {
                    return totalValue - baseValue;
                }
                numMerges = requiredNumMerges;
                totalValue = baseValue + roundUp(baseFee + transferFee.value * BigInt(numMerges), feeSignificantFigures);
            }
            // Need to deposit or transfer one more note with enough value.
            const numNotes = 1 + (await getNumNotes(spendableValue));
            const expectedNumMerges = Math.max(0, numNotes - 2);
            return roundUp(baseFee + transferFee.value * BigInt(expectedNumMerges), feeSignificantFigures);
        };
        return await Promise.all(fees.map(async (fee) => ({ ...fee, value: await getTotalFee(fee.value) })));
    }
    async getAccountFees(assetId, { feeSignificantFigures = 0 }) {
        const txFees = await this.core.getTxFees(assetId);
        const [depositFee] = txFees[TxType.DEPOSIT];
        return txFees[TxType.ACCOUNT].map(fee => ({
            ...fee,
            value: roundUp(fee.value + depositFee.value, feeSignificantFigures),
        }));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVlX2NhbGN1bGF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYXp0ZWNfc2RrL2ZlZV9jYWxjdWxhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUV4RCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ2pILE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUl2RCxNQUFNLFVBQVUsR0FBRyxDQUFDLEtBQW1CLEVBQUUsS0FBbUIsRUFBRSxFQUFFLENBQzlELENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFFakcsTUFBTSxjQUFjLEdBQUcsQ0FBQyxLQUFtQixFQUFFLEtBQW1CLEVBQUUsRUFBRSxDQUNsRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBUzVGLE1BQU0sT0FBTyxhQUFhO0lBQ3hCLFlBQTZCLElBQWEsRUFBbUIsVUFBb0M7UUFBcEUsU0FBSSxHQUFKLElBQUksQ0FB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